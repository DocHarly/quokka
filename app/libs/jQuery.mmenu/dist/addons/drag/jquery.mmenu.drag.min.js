/*	
 * jQuery mmenu drag add-on
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
!function(e){function n(e,n,t){return e<n&&(e=n),e>t&&(e=t),e}function t(t,o,a){var r,p,c,f,d,l=this,u={},m=0,h=!1,g=!1,v=0,b=0;switch(this.opts.offCanvas.position){case"left":case"right":u.events="panleft panright",u.typeLower="x",u.typeUpper="X",g="width";break;case"top":case"bottom":u.events="panup pandown",u.typeLower="y",u.typeUpper="Y",g="height"}switch(this.opts.offCanvas.position){case"right":case"bottom":u.negative=!0,f=function(e){e>=a.$wndw[g]()-t.maxStartPos&&(m=1)};break;default:u.negative=!1,f=function(e){e<=t.maxStartPos&&(m=1)}}switch(this.opts.offCanvas.position){case"left":u.open_dir="right",u.close_dir="left";break;case"right":u.open_dir="left",u.close_dir="right";break;case"top":u.open_dir="down",u.close_dir="up";break;case"bottom":u.open_dir="up",u.close_dir="down"}switch(this.opts.offCanvas.zposition){case"front":d=function(){return this.$menu};break;default:d=function(){return e("."+i.slideout)}}var w=this.__valueOrFn(t.node,this.$menu,a.$page);"string"==typeof w&&(w=e(w));var _=new Hammer(w[0],this.opts[s].vendors.hammer);_.on("panstart",function(e){f(e.center[u.typeLower]),a.$slideOutNodes=d(),h=u.open_dir}).on(u.events+" panend",function(e){m>0&&e.preventDefault()}).on(u.events,function(e){if(r=e["delta"+u.typeUpper],u.negative&&(r=-r),r!=v&&(h=r>=v?u.open_dir:u.close_dir),v=r,v>t.threshold&&1==m){if(a.$html.hasClass(i.opened))return;m=2,l._openSetup(),l.trigger("open:start"),a.$html.addClass(i.dragging),b=n(a.$wndw[g]()*o[g].perc,o[g].min,o[g].max)}2==m&&(p=n(v,10,b)-("front"==l.opts.offCanvas.zposition?b:0),u.negative&&(p=-p),c="translate"+u.typeUpper+"("+p+"px )",a.$slideOutNodes.css({"-webkit-transform":"-webkit-"+c,transform:c}))}).on("panend",function(e){2==m&&(a.$html.removeClass(i.dragging),a.$slideOutNodes.css("transform",""),l[h==u.open_dir?"_openFinish":"close"]()),m=0})}function o(e,n,t,o){var a=this,p=e.data(r.parent);if(p){p=p.closest("."+i.panel);var c=new Hammer(e[0],a.opts[s].vendors.hammer),f=null;c.on("panright",function(e){f||(a.openPanel(p),f=setTimeout(function(){clearTimeout(f),f=null},a.conf.openingInterval+a.conf.transitionDuration))})}}var a="mmenu",s="drag";e[a].addons[s]={setup:function(){if(this.opts.offCanvas){var n=this.opts[s],i=this.conf[s];c=e[a].glbl,"boolean"==typeof n&&(n={menu:n,panels:n}),"object"!=typeof n&&(n={}),"boolean"==typeof n.menu&&(n.menu={open:n.menu}),"object"!=typeof n.menu&&(n.menu={}),"boolean"==typeof n.panels&&(n.panels={close:n.panels}),"object"!=typeof n.panels&&(n.panels={}),n=this.opts[s]=e.extend(!0,{},e[a].defaults[s],n),n.menu.open&&this.bind("setPage:after",function(){t.call(this,n.menu,i.menu,c)}),n.panels.close&&this.bind("initPanel:after",function(e){o.call(this,e,n.panels,i.panels,c)})}},add:function(){return"function"!=typeof Hammer||Hammer.VERSION<2?(e[a].addons[s].add=function(){},void(e[a].addons[s].setup=function(){})):(i=e[a]._c,r=e[a]._d,p=e[a]._e,void i.add("dragging"))},clickAnchor:function(e,n){}},e[a].defaults[s]={menu:{open:!1,maxStartPos:100,threshold:50},panels:{close:!1},vendors:{hammer:{}}},e[a].configuration[s]={menu:{width:{perc:.8,min:140,max:440},height:{perc:.8,min:140,max:880}},panels:{}};var i,r,p,c}(jQuery);